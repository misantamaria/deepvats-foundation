---

title: Baseline Models


keywords: fastai
sidebar: home_sidebar

summary: "This notebook tries generate baseline models to evaluate if DCAE models have a good performance or nor"
description: "This notebook tries generate baseline models to evaluate if DCAE models have a good performance or nor"
nb_path: "nbs/04_baseline_models.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/04_baseline_models.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a run to save the models (job_type = "baseline_models")</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-the-datasets">Load the datasets<a class="anchor-link" href="#Load-the-datasets"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">artifact_name_and_version</span> <span class="o">=</span> <span class="s1">&#39;JNK:train_10days&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds_train_artifact</span> <span class="o">=</span> <span class="n">run_baseline</span><span class="o">.</span><span class="n">use_artifact</span><span class="p">(</span><span class="n">artifact_name_and_version</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
    <span class="p">{</span>
          <span class="s1">&#39;ds_train_artifact_type&#39;</span><span class="p">:</span> <span class="n">ds_train_artifact</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
          <span class="s1">&#39;ds_train_artifact_name&#39;</span><span class="p">:</span> <span class="n">ds_train_artifact</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
          <span class="s1">&#39;ds_train_artifact_digest&#39;</span><span class="p">:</span> <span class="n">ds_train_artifact</span><span class="o">.</span><span class="n">digest</span><span class="p">,</span>
    <span class="p">},</span> 
    <span class="n">allow_val_change</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ds_train_artifact</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ds_train_artifact</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ds_train_artifact</span><span class="o">.</span><span class="n">digest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;dataset&#39;, &#39;JNK:v6&#39;, &#39;59d36b625c02415285418566f626f154&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">ds_train_artifact</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RCD_AverageThree-phaseCurrent</th>
      <th>LCD_AverageThree-phaseCurrent</th>
      <th>LP_AverageThree-phaseCurrent</th>
      <th>LHD_LeftHaulageDrive(tractor)Temperature(gearbox)</th>
      <th>RHD_RightHaulageDrive(tractor)Temperature(gearbox)</th>
      <th>LA_LeftArmTemperature</th>
      <th>RA_RightArmTemperature</th>
      <th>SM_DailyRouteOfTheShearer</th>
      <th>SM_TotalRoute</th>
      <th>LHD_EngineCurrent</th>
      <th>RHD_EngineCurrent</th>
      <th>RCD_BearingTemperature</th>
      <th>SM_ShearerSpeed</th>
      <th>SM_ShearerLocation</th>
      <th>SM_ShearerMoveInLeft</th>
      <th>SM_ShearerMoveInRight</th>
    </tr>
    <tr>
      <th>TIMESTAMP</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-06-01</th>
      <td>-0.97812</td>
      <td>-1.026472</td>
      <td>-0.668515</td>
      <td>-2.136844</td>
      <td>-0.408555</td>
      <td>-3.033168</td>
      <td>-2.727174</td>
      <td>-0.982279</td>
      <td>-11.529689</td>
      <td>-0.572725</td>
      <td>-0.572323</td>
      <td>-3.462614</td>
      <td>-0.38534</td>
      <td>0.653245</td>
      <td>-0.267602</td>
      <td>-0.341987</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train">Train<a class="anchor-link" href="#Train"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sliding-window-features">Sliding window features<a class="anchor-link" href="#Sliding-window-features"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">ifnone</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">),</span> <span class="mi">48</span><span class="p">)</span>
<span class="n">config</span><span class="o">.</span><span class="n">stride</span> <span class="o">=</span> <span class="n">ifnone</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stride&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">config</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">ifnone</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">w</span><span class="p">,</span>
    <span class="s1">&#39;stride&#39;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">stride</span><span class="p">,</span>
    <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">t</span>  <span class="c1"># TODO: Not supported yet</span>
    <span class="p">},</span> <span class="n">allow_val_change</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">w</span> <span class="o">%</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_data</span> <span class="o">=</span> <span class="n">df_slicer</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">stride</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_test</span> <span class="o">=</span> <span class="n">input_data</span><span class="c1">#Take 10 windows data_test[0:10,:,:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(172753, 48, 16)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="baseline_model_predictor" class="doc_header"><code>baseline_model_predictor</code><a href="https://gitlab.geist.re/pml/x_timecluster_extension/tree/master/timecluster_extension/utils.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>baseline_model_predictor</code>(<strong><code>input_array</code></strong>, <strong><code>operation</code></strong>=<em><code>'mean'</code></em>)</p>
</blockquote>
<p>Perform an arithmetic operation (median or average) on a three-dimensional numpy array from df_slicer</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baseline_type</span> <span class="o">=</span> <span class="s2">&quot;median&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">baseline_model_predictor</span><span class="p">(</span><span class="n">data_test</span><span class="p">,</span> <span class="n">baseline_type</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(172753, 48, 16)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
        <span class="s1">&#39;baseline_type&#39;</span><span class="p">:</span> <span class="n">baseline_type</span>
    <span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">data_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_windows_mse" class="doc_header"><code>get_windows_mse</code><a href="https://gitlab.geist.re/pml/x_timecluster_extension/tree/master/timecluster_extension/utils.py#L42" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_windows_mse</code>(<strong><code>predictions</code></strong>, <strong><code>original_data</code></strong>)</p>
</blockquote>
<p>Function that calculates the mse for each of the windows in which an auto-encoder model has made a prediction.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">windows_mse</span> <span class="o">=</span> <span class="n">get_windows_mse</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span><span class="n">data_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 3.41 s, sys: 6.98 s, total: 10.4 s
Wall time: 4.62 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">windows_mse</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(172753, 16)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>MSE per time series</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">windows_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.25210897, 0.19519041, 0.29240048, 0.02972069, 0.02183987,
       0.07060798, 0.03001558, 0.01942385, 0.45632429, 0.28657532,
       0.2848851 , 0.04863259, 0.37448899, 0.0024526 , 0.43402708,
       0.46250715])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Total MSE:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">windows_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.2038250601232007</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Log results on wandb:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run_baseline</span><span class="o">.</span><span class="n">log</span><span class="p">({</span>
    <span class="s1">&#39;mse_overall&#39;</span><span class="p">:</span> <span class="n">windows_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
    <span class="s1">&#39;mse_signal&#39;</span><span class="p">:</span> <span class="n">windows_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># MSE of each variable</span>
    <span class="s1">&#39;mse_raw&#39;</span><span class="p">:</span> <span class="n">windows_mse</span> <span class="c1"># Raw mse. It has the mse for each window and signal</span>
<span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-blue-intense-fg ansi-bold">wandb</span>: <span class="ansi-yellow-fg">WARNING</span> Serializing object of type ndarray that is 22112496 bytes
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plot figure to visualize MSE per variable:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span>  <span class="n">windows_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MSE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="p">)</span>


<span class="n">wandb</span><span class="o">.</span><span class="n">log</span><span class="p">({</span><span class="s2">&quot;mse_signal_plot&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run_baseline</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<br/>Waiting for W&B process to finish, PID 91929<br/>Program ended successfully.
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Find user logs for this run at: <code>wandb/run-20201103_114746-33z7rl06/logs/debug.log</code>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Find internal logs for this run at: <code>wandb/run-20201103_114746-33z7rl06/logs/debug-internal.log</code>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<h3>Run summary:</h3><br/><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: right }
    </style><table class="wandb">
<tr><td>mse_overall</td><td>0.20383</td></tr><tr><td>_step</td><td>1</td></tr><tr><td>_runtime</td><td>35</td></tr><tr><td>_timestamp</td><td>1604404101</td></tr></table>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<h3>Run history:</h3><br/><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: right }
    </style><table class="wandb">
<tr><td>mse_overall</td><td>▁</td></tr><tr><td>_step</td><td>▁█</td></tr><tr><td>_runtime</td><td>▁▁</td></tr><tr><td>_timestamp</td><td>▁▁</td></tr></table><br/>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Synced 5 W&B file(s), 1 media file(s), 0 artifact file(s) and 0 other file(s)
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

                    <br/>Synced <strong style="color:#cdcd00">generous-field-232</strong>: <a href="https://wandb.ai/pacmel/timecluster-extension/runs/33z7rl06" target="_blank">https://wandb.ai/pacmel/timecluster-extension/runs/33z7rl06</a><br/>
                
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It proves that <code>get_windows_mse()</code> is working correctly compared to the sklearn function. This check is done because the function is swapped, and it is convenient that the results are the same regardless of the method used.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="n">rme_sklearn</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
    <span class="n">y_pred_sel</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">]</span>
    <span class="n">test_sel</span> <span class="o">=</span> <span class="n">data_test</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">]</span>
    <span class="n">rme_sklearn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_sel</span><span class="p">,</span><span class="n">y_pred_sel</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 2.98 s, sys: 634 ms, total: 3.61 s
Wall time: 3.61 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rme_sklearn_round</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">rme_sklearn</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">rme_keras_round</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">windows_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">all_equal</span><span class="p">(</span><span class="n">rme_sklearn_round</span><span class="p">,</span> <span class="n">rme_keras_round</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

