[1] [ --> _set_encoder ]
[1]  [ _set_encoder ] About to exec _set_enc_input
[1]  [ _set_encoder ] enc_input~(429, 1, 12)
[1]  [ _set_encoder ] About to exec _set_optimizer
[1] [_set_encoder --> ]
[1] [ --> fine_tune ]
[1]  [ fine_tune ] Use fine_tune_moment parameters
[1] [91m [ fine_tune ] Processing wlen 12 | wlens [] | i 1/1[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 2[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 424[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 429[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 129 | 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 75[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 0[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 298[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 300[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 75 | 75[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.06199445652111986, 'rmse': 0.0039400978526056, 'mae': 0.03767751799688797, 'smape': 0.24046975439655038, 'loss': 0.0036033615631620502}.[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.20997706740163266[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.26819596886929986, 'rmse': 0.09205670527305447, 'mae': 0.18346788078842524, 'smape': 0.8373074198741569, 'loss': 0.08399660202364127}.[0m
2025-02-03 11:42:40.710 | mse: 0.06199445652111986
2025-02-03 11:42:40.710 | rmse: 0.0039400978526056
2025-02-03 11:42:40.710 | mae: 0.03767751799688797
2025-02-03 11:42:40.711 | smape: 0.24046975439655038
2025-02-03 11:42:40.711 | loss: 0.0036033615631620502
2025-02-03 11:42:40.711 | mse: 0.26819596886929986
2025-02-03 11:42:40.712 | rmse: 0.09205670527305447
2025-02-03 11:42:40.712 | mae: 0.18346788078842524
2025-02-03 11:42:40.712 | smape: 0.8373074198741569
2025-02-03 11:42:40.712 | loss: 0.08399660202364127
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [fine_tune --> ]
[1] [ --> _set_encoder ]
[1]  [ _set_encoder ] About to exec _set_enc_input
[1]  [ _set_encoder ] enc_input~(433, 1, 8)
[1]  [ _set_encoder ] About to exec _set_optimizer
[1] [_set_encoder --> ]
[1] [ --> fine_tune ]
[1]  [ fine_tune ] Use fine_tune_moment parameters
[1] [91m [ fine_tune ] Processing wlen 8 | wlens [] | i 1/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 130[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 3[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 427[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 433[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 130 | 130[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 76[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 1[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 300[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 303[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 76 | 76[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.0438618396711266, 'rmse': 0.0019513328731334458, 'mae': 0.022799667361407327, 'smape': 0.18096413926065702, 'loss': 0.0018704726713218002}.[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.3680720488773659[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.07804862235454843, 'rmse': 0.008745296697244756, 'mae': 0.043219411430450584, 'smape': 0.2620736430705798, 'loss': 0.008146696432959288}.[0m
2025-02-03 11:42:58.476 | mse: 0.0438618396711266
2025-02-03 11:42:58.477 | rmse: 0.0019513328731334458
2025-02-03 11:42:58.477 | mae: 0.022799667361407327
2025-02-03 11:42:58.478 | smape: 0.18096413926065702
2025-02-03 11:42:58.478 | loss: 0.0018704726713218002
2025-02-03 11:42:58.478 | mse: 0.07804862235454843
2025-02-03 11:42:58.478 | rmse: 0.008745296697244756
2025-02-03 11:42:58.479 | mae: 0.043219411430450584
2025-02-03 11:42:58.479 | smape: 0.2620736430705798
2025-02-03 11:42:58.479 | loss: 0.008146696432959288
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [91m [ fine_tune ] Processing wlen 10 | wlens [8] | i 2/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 130[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 0[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 425[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 431[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 130 | 130[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 76[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 2[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 296[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 301[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 76 | 76[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 1.0093805965967477[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([2, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([2, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.07338369441141002, 'rmse': 0.005590283338214987, 'mae': 0.038955652557062695, 'smape': 0.27647279422884635, 'loss': 0.00536218556549607}.[0m
2025-02-03 11:43:07.642 | mse: 0.07338369441141002
2025-02-03 11:43:07.643 | rmse: 0.005590283338214987
2025-02-03 11:43:07.643 | mae: 0.038955652557062695
2025-02-03 11:43:07.643 | smape: 0.27647279422884635
2025-02-03 11:43:07.644 | loss: 0.00536218556549607
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [91m [ fine_tune ] Processing wlen 12 | wlens [8, 10] | i 3/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 11[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 427[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 429[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 129 | 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 75[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 2[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 298[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 300[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 75 | 75[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.4100254584569484[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([1, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([1, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.9091386659410144, 'rmse': 0.9213559031518698, 'mae': 0.5660278338121337, 'smape': 1.4551078827193304, 'loss': 0.8650216774808036}.[0m
2025-02-03 11:43:16.378 | mse: 0.9091386659410144
2025-02-03 11:43:16.378 | rmse: 0.9213559031518698
2025-02-03 11:43:16.379 | mae: 0.5660278338121337
2025-02-03 11:43:16.379 | smape: 1.4551078827193304
2025-02-03 11:43:16.379 | loss: 0.8650216774808036
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [91m [ fine_tune ] Processing wlen 16 | wlens [8, 10, 12] | i 4/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 128[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 6[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 423[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 425[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 128 | 128[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 75[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 6[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 294[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 297[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 75 | 75[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.7822073578834534[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.10342036885506734, 'rmse': 0.012574960159278973, 'mae': 0.061704447714419075, 'smape': 0.521500460585981, 'loss': 0.012574960361234844}.[0m
2025-02-03 11:43:24.650 | mse: 0.10342036885506734
2025-02-03 11:43:24.651 | rmse: 0.012574960159278973
2025-02-03 11:43:24.651 | mae: 0.061704447714419075
2025-02-03 11:43:24.651 | smape: 0.521500460585981
2025-02-03 11:43:24.651 | loss: 0.012574960361234844
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [91m [ fine_tune ] Processing wlen 17 | wlens [8, 10, 12, 16] | i 5/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 128[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 4[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 422[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 424[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 128 | 128[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 74[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 1[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 289[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 296[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 74 | 74[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 1.3045454451814293[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.5778141744601184, 'rmse': 0.37352425956749646, 'mae': 0.3813777577224755, 'smape': 1.3036986519480132, 'loss': 0.37352426815778017}.[0m
2025-02-03 11:43:32.826 | mse: 0.5778141744601184
2025-02-03 11:43:32.827 | rmse: 0.37352425956749646
2025-02-03 11:43:32.827 | mae: 0.3813777577224755
2025-02-03 11:43:32.828 | smape: 1.3036986519480132
2025-02-03 11:43:32.828 | loss: 0.37352426815778017
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [fine_tune --> ]
[1] [ --> _set_encoder ]
[1]  [ _set_encoder ] About to exec _set_enc_input
[1]  [ _set_encoder ] enc_input~(429, 1, 12)
[1]  [ _set_encoder ] About to exec _set_optimizer
[1] [_set_encoder --> ]
[1] [ --> fine_tune ]
[1]  [ fine_tune ] Use fine_tune_moment parameters
[1] [91m [ fine_tune ] Processing wlen 12 | wlens [] | i 1/1[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 4[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 427[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 429[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 129 | 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 75[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 0[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 294[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 300[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 75 | 75[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.07429887820184936, 'rmse': 0.005558927405671288, 'mae': 0.043768347375448644, 'smape': 0.239247488253993, 'loss': 0.005091560331897603}.[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.18682329520233906[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.20903876494144774, 'rmse': 0.05326253399716894, 'mae': 0.13584041077816902, 'smape': 0.7291492338171007, 'loss': 0.04843618275804652}.[0m
2025-02-03 11:43:51.767 | mse: 0.07429887820184936
2025-02-03 11:43:51.767 | rmse: 0.005558927405671288
2025-02-03 11:43:51.768 | mae: 0.043768347375448644
2025-02-03 11:43:51.768 | smape: 0.239247488253993
2025-02-03 11:43:51.768 | loss: 0.005091560331897603
2025-02-03 11:43:51.769 | mse: 0.20903876494144774
2025-02-03 11:43:51.769 | rmse: 0.05326253399716894
2025-02-03 11:43:51.769 | mae: 0.13584041077816902
2025-02-03 11:43:51.769 | smape: 0.7291492338171007
2025-02-03 11:43:51.770 | loss: 0.04843618275804652
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [fine_tune --> ]
[1] [ --> _set_encoder ]
[1]  [ _set_encoder ] About to exec _set_enc_input
[1]  [ _set_encoder ] enc_input~(433, 1, 8)
[1]  [ _set_encoder ] About to exec _set_optimizer
[1] [_set_encoder --> ]
[1] [ --> fine_tune ]
[1]  [ fine_tune ] Use fine_tune_moment parameters
[1] [91m [ fine_tune ] Processing wlen 8 | wlens [] | i 1/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 130[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 6[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 429[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 433[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 130 | 130[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 76[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 2[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 285[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 303[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 76 | 76[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.05307835718562258, 'rmse': 0.0029473731044136068, 'mae': 0.02814199979094645, 'smape': 0.1993917907258292, 'loss': 0.002726512488960806}.[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.11590638260822743[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.2114798142781576, 'rmse': 0.058712869514579796, 'mae': 0.12357613508625387, 'smape': 0.6737824796514836, 'loss': 0.05389879198951854}.[0m
2025-02-03 11:44:09.155 | mse: 0.05307835718562258
2025-02-03 11:44:09.156 | rmse: 0.0029473731044136068
2025-02-03 11:44:09.156 | mae: 0.02814199979094645
2025-02-03 11:44:09.156 | smape: 0.1993917907258292
2025-02-03 11:44:09.156 | loss: 0.002726512488960806
2025-02-03 11:44:09.157 | mse: 0.2114798142781576
2025-02-03 11:44:09.157 | rmse: 0.058712869514579796
2025-02-03 11:44:09.157 | mae: 0.12357613508625387
2025-02-03 11:44:09.157 | smape: 0.6737824796514836
2025-02-03 11:44:09.158 | loss: 0.05389879198951854
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [91m [ fine_tune ] Processing wlen 10 | wlens [8] | i 2/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 130[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 4[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 429[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 431[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 130 | 130[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 76[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 6[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 296[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 301[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 76 | 76[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.41185712395235896[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([2, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([2, 10]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.22095077747077924, 'rmse': 0.058908873498152436, 'mae': 0.1350088174822024, 'smape': 0.9413201548545983, 'loss': 0.0553331213692824}.[0m
2025-02-03 11:44:17.922 | mse: 0.22095077747077924
2025-02-03 11:44:17.923 | rmse: 0.058908873498152436
2025-02-03 11:44:17.923 | mae: 0.1350088174822024
2025-02-03 11:44:17.923 | smape: 0.9413201548545983
2025-02-03 11:44:17.923 | loss: 0.0553331213692824
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [91m [ fine_tune ] Processing wlen 12 | wlens [8, 10] | i 3/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 0[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 425[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 429[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 129 | 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 75[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 2[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 298[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 300[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 75 | 75[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.5272894445806742[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([1, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([1, 12]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.34344352944671974, 'rmse': 0.15775567104494387, 'mae': 0.2068255109199893, 'smape': 0.7449360658876585, 'loss': 0.1435495170040263}.[0m
2025-02-03 11:44:26.681 | mse: 0.34344352944671974
2025-02-03 11:44:26.682 | rmse: 0.15775567104494387
2025-02-03 11:44:26.682 | mae: 0.2068255109199893
2025-02-03 11:44:26.682 | smape: 0.7449360658876585
2025-02-03 11:44:26.682 | loss: 0.1435495170040263
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [91m [ fine_tune ] Processing wlen 16 | wlens [8, 10, 12] | i 4/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 128[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 1[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 424[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 425[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 128 | 128[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 75[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 4[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 290[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 297[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 75 | 75[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.3307917669415474[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 16]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.21154520643126157, 'rmse': 0.05098608035902301, 'mae': 0.13520640440219722, 'smape': 0.9917582316949176, 'loss': 0.05098608089610934}.[0m
2025-02-03 11:44:34.975 | mse: 0.21154520643126157
2025-02-03 11:44:34.976 | rmse: 0.05098608035902301
2025-02-03 11:44:34.976 | mae: 0.13520640440219722
2025-02-03 11:44:34.977 | smape: 0.9917582316949176
2025-02-03 11:44:34.977 | loss: 0.05098608089610934
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [91m [ fine_tune ] Processing wlen 17 | wlens [8, 10, 12, 16] | i 5/5[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 128[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 4[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 422[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 424[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 128 | 128[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 74[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 0[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 294[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 296[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 74 | 74[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_loop_step_ ] Executing in device cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_train_ ] Best Loss inf -> 0.40805989168584345[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch 0[0m
[1] [91m [ fine_tune_moment_train_ ] Best epoch: 0[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ check_batch_masks ] Invalid batch masks shape torch.Size([16, 8]).[0m
[1] [91m [ check_batch_masks ] Modified to torch.Size([16, 17]) adding 0's.[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
[1] [91m [ fine_tune_moment_single_ ] Eval results: {'mse': 0.1545907718379001, 'rmse': 0.03006327079823598, 'mae': 0.09078504184981284, 'smape': 0.5194718728146681, 'loss': 0.030063270358368754}.[0m
2025-02-03 11:44:43.205 | mse: 0.1545907718379001
2025-02-03 11:44:43.205 | rmse: 0.03006327079823598
2025-02-03 11:44:43.206 | mae: 0.09078504184981284
2025-02-03 11:44:43.206 | smape: 0.5194718728146681
2025-02-03 11:44:43.206 | loss: 0.030063270358368754
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] Eval post: [0m
[1] [91m [ fine_tune ] best_epoch: [0m
[1] [fine_tune --> ]
[1] [ --> _set_encoder ]
[1]  [ _set_encoder ] About to exec _set_enc_input
[1]  [ _set_encoder ] enc_input~(429, 1, 12)
[1]  [ _set_encoder ] About to exec _set_optimizer
[1] [_set_encoder --> ]
[1] [ --> fine_tune ]
[1]  [ fine_tune ] Use fine_tune_moment parameters
[1] [91m [ fine_tune ] Processing wlen 12 | wlens [] | i 1/1[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 1[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 428[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 429[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 129 | 129[0m
[1] [91m [ set_train_and_eval_dataloaders ] n_windows: 75[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (smallest): 4[0m
[1] [91m [ set_train_and_eval_dataloaders ] Index (largest): 299[0m
[1] [91m [ set_train_and_eval_dataloaders ] Total: 300[0m
[1] [91m [ set_train_and_eval_dataloaders ] Eval: 75 | 75[0m
[1] [91m [ fine_tune_moment_single_ ] Executing in devicecuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Using device: 1[0m
[1] [91m [ moment_safe_forward_pass ] CUDA is available: True[0m
[1] [91m [ moment_safe_forward_pass ] Model device: cuda:1[0m
[1] [91m [ moment_safe_forward_pass ] Devices: batch - cuda:1 | input_mask - cuda:1 | mask - cuda:1.[0m
[1] [91m [ moment_compute_loss ] Criterion: MSELoss()[0m
